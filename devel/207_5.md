# 207_5 lolly url相关性能问题

## 2025/07/14 增加长URL的bench
### What
增加了新的测试项

### what
原先的测试项目不足以测试长URL的性能


## 2025/07/14 格式化文件

### What
使用./bin/format格式化文件

### Why
之前文件未格式化

## 2025/07/09 优化 Lolly 的 `as_string()` 性能瓶颈

### What
重写 `as_string()`，使用 `string_builder` 替代递归拼接。将算法复杂度从 O(n²) 降至 O(n)，在保持浅层 URL 性能基本不变的前提下，显著提升了深层 URL 的处理效率。

### Why
原有实现中对深层 URL 存在大量重复字符串构造，导致性能退化。以深度为 1000 的 URL 为例，优化前耗时约 923,000 ns，优化后缩短至 373,000 ns，提升约 60%。

### How
引入 `string_builder` 类，在深度优先遍历 URL 结构的过程中按顺序构造字符缓冲，避免临时字符串对象的频繁分配。新的实现通过 `as_string_impl()` 进行递归写入，最终调用 `to_string()` 输出完整字符串。同时保留了原始的 `legacy_as_string()`，对浅层结构沿用旧路径以控制常数开销。
