# 207_9 strong标记下扳手的点击延迟 

本次优化对于所有宏的扳手符号适用，不只\strong

## 2025/08/11 增加缓存机制

### Why
点击扳手时使用了全局搜索，这一步会触发样式索引扫描/文件系统访问，启动需要几秒钟加载

### What
strong 直接命中 common-style-packages → 立即得到 "std-markup"，并写入缓存。以后再点任何地方的扳手，同名宏直接从缓存返回，就算是非常见宏，也只慢一次（首次搜到后放进缓存）。

### How
macro-source-cache 用宏名作键，保存的结果；下次再问同一个宏，常数时间返回，不再触发全局扫描。


1. 本地定义（get-definition* l (buffer-tree)）：如果用户在当前文档/包里重定义了宏，直接用它

2. 常见映射（common-style-packages）：最常用宏直接跳到对应包（std-markup / std-list），避免落到重活

3. 全局搜索（search-style-package）：真的找不到再跑这一步并缓存结果

### notice
目前仅仅定义了3种常用包
```scheme
(define common-style-packages
  '(("strong" . "std-markup")
    ("item" . "std-list")
    ("list" . "std-list")))
```
针对其他的宏的扳手符号，最多会在第一次使用时卡顿，如果想要完全消除可以编辑
`/mogan/TeXmacs/progs/source/macro-edit.scm` 的 `common-style-packages` 增加映射。