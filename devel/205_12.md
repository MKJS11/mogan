# 205_12 使用MuPDF获取图片大小
## 如何测试
1. 调试菜单启用convert输出，打开`TeXmacs/tests/tmu/205_12.tmu`这个文档，观察输出与显示效果。
2. 向文档中拖拽插入其他格式的图片（bmp, tiff, pdf等），可以正确识别图片

## 2025/09/13
### What
1. 根据[[201_22] 拖拽图片到编辑器时直接嵌入](https://gitee.com/XmacsLabs/mogan/pulls/662)的思想，基于MuPDF技术栈，实现同样功能的`mupdf_load_and_parse_image`，该函数完成拖拽图片时，加载与解析图片大小的工作。
2. 根据[[201_21] 粘贴链接图片时直接嵌入图片](https://gitee.com/XmacsLabs/mogan/pulls/651)的思想，改用`mupdf_load_and_parse_image`实现相同功能。
3. 在拖拽插入图片的场景支持更多图片格式
4. 新实现`mupdf_read_from_url`，用于读取URL内容

### Why
基于MuPDF完成拖拽嵌入图片场景的适配

## 2025/09/10
### What
参考`qt_image_size()`：
1. 实现`mupdf_normal_image_size()`获取普通图片大小。
2. 实现`mupdf_pdf_image_size()`获取PDF图片的大小。
上述两个函数将替代原有的`qt_image_size()`和`hummus_pdf_image_size()`

### Why
原有`hummus_pdf_image_size()`获取PDF尺寸时，未考虑编辑器的 pt, px 单位转换，造成同一尺寸图片，在转换为PDF插入后相比原格式会变大
在启用MuPDF渲染器后，使用MuPDF图片解析功能获取各种图片的大小。
